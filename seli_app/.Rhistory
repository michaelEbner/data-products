table(df$How.often.do.you.purchase.from.THE.ICONIC.)
#segments
raw$customer_type <- table(ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == "I haven't made a purchase yet",'poential',
iflese(raw$How.often.do.you.purchase.from.THE.ICONIC. == "This is my first purchsae","new",
"existing")))
#segments
raw$customer_type <- table(ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == "I haven't made a purchase yet",'poential',
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == "This is my first purchsae","new",
"existing")))
raw <- df
#segments
raw$customer_type <- table(ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == "I haven't made a purchase yet",'poential',
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == "This is my first purchsae","new",
"existing")))
#reshape data
subdf <- raw %>%
subset(!is.na(For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.)) %>%
select(Response.ID,customer_type,Time.Started,City,For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
mutate(month = round_date(as.Date(Time.Started),"month")) %>%
select(month,customer_type,Response.ID,City,For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
dplyr::rename(feedback = For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
mutate(feedback = as.character(feedback),month = as.character(month))
#keywords
word_list <- data.frame(variable = subdf$feedback,stringsAsFactors =F ) %>%
mutate(variable = str_replace_all(variable, "[[:punct:]]", " ")) %>%
mutate(variable = str_split(variable,' ')) %>%
unnest() %>% subset(grepl("[A-Za-z]", variable)) %>%
mutate(variable = tolower(variable)) %>%
mutate(var_length = nchar(variable)) %>%
subset(var_length > 2)
word_list <- as.data.frame(table(word_list$variable))
word_list$perc <- round(word_list$Freq / sum(word_list$Freq),4)
#attribution
subdf$social <- ifelse(grepl("soci|facebook|facbook|faceb|influenc|instagram|pinterest|snapc|qzone|weibo|twitter|reddit|flickr|linkedin|whtasapp|vlogger|tweet|tumblr|post|blog", subdf$feedback),1,0)
subdf$sea <- ifelse(grepl("adwo|search add|organic|yahoo", subdf$feedback),1,0)
subdf$seo <- ifelse(grepl("seo|google|organic|yahoo", subdf$feedback),1,0)
subdf$crm <- ifelse(grepl("newsletter|mail|notifi", subdf$feedback),1,0)
subdf$display <- ifelse(grepl("banner|display", subdf$feedback),1,0)
subdf$iconic <- ifelse(grepl("iconic", subdf$feedback),1,0)
subdf$pricing <- ifelse(grepl("price|bargain|cheap|expensive|deal|sale|discount|vouch", subdf$feedback),1,0)
subdf$shipping <- ifelse(grepl("ship", subdf$feedback),1,0)
subdf$presentation <- ifelse(grepl("pictur|photo|photo|models|video|graph|virtual|visual|diversit",subdf$feedback),1,0)
subdf$features <- ifelse(grepl("watchlist|web|page|recommend|perso.nal|shop|wishlist|inspir|interact|scroll|lookbook",subdf$feedback),1,0)
subdf$brands <- ifelse(grepl("adidas|nike|billabong|birkenstock|birdsnest|tommi|tomboy|reebok|ralph|lauren|oxygen",subdf$feedback),1,0)
subdf$assortment <- ifelse(grepl("assort|baby|babie|basics|basketball|baskets|beach|black|blazer|waterproof|uniform|trainer|tracksuit|toddler|theiconicmen|theiconicsports|shirt|jeans|swim|sunglass|summer|racewear|race|petit|outerwear|outdoor|styles|outfit|tailored|variety|accessor|colour|categories|festival|everywhere",subdf$feedback),1,0)
sent <- with(subdf,sentiment_by(get_sentences(feedback),list(Response.ID)))
out <- merge(subdf,sent,by = "Response.ID")
social <- out %>% subset(social == 1) %>% mutate(topic = paste0('social (',nrow(out %>% subset(social == 1)),')'))
sea <- out %>% subset(sea == 1) %>% mutate(topic = paste0('sea (',nrow(out %>% subset(sea == 1)),')'))
seo <- out %>% subset(seo == 1) %>% mutate(topic = paste0('seo (',nrow(out %>% subset(seo == 1)),')'))
crm <- out %>% subset(crm == 1) %>% mutate(topic = paste0('crm (',nrow(out %>% subset(crm == 1)),')'))
display  <- out %>% subset(display == 1) %>% mutate(topic = paste0('display (',nrow(out %>% subset(display == 1)),')'))
iconic <- out %>% subset(iconic == 1) %>% mutate(topic = paste0('iconic (',nrow(out %>% subset(iconic == 1)),')'))
pricing  <- out %>% subset(pricing == 1) %>% mutate(topic = paste0('pricing (',nrow(out %>% subset(pricing == 1)),')'))
shipping  <- out %>% subset(shipping == 1) %>% mutate(topic = paste0('shipping (',nrow(out %>% subset(shipping == 1)),')'))
presentation  <- out %>% subset(presentation == 1) %>% mutate(topic = paste0('presentation (',nrow(out %>% subset(presentation == 1)),')'))
features  <- out %>% subset(features == 1) %>% mutate(topic = paste0('features (',nrow(out %>% subset(features == 1)),')'))
brands  <- out %>% subset(brands == 1) %>% mutate(topic = paste0('brands (',nrow(out %>% subset(brands == 1)),')'))
assortment  <- out %>% subset(assortment == 1) %>% mutate(topic = paste0('assortment (',nrow(out %>% subset(assortment == 1)),')'))
final <- rbind(social,sea,seo,crm,display,iconic,pricing,shipping,presentation,features,brands,assortment)
ggplot(final, aes(x=reorder(topic,ave_sentiment,FUN= median),y=ave_sentiment,color=topic)) +
geom_boxplot()+
#facet_grid(connie_applink_active~.,scales = "free")+
scale_y_continuous(breaks = seq(-2,2, by=.25), limits = c(-1.25,2.25))+
#atlassian_theme +
labs(title = 'Sentiment by Topic',
y = 'sentiment score',
x = ' ')+
theme_light()
ggplot(final, aes(x=customer_type,y=ave_sentiment,color=month)) +
geom_boxplot()+
#facet_grid(connie_applink_active~.,scales = "free")+
scale_y_continuous(breaks = seq(-2,2, by=.25), limits = c(-1.25,2.25))+
#atlassian_theme +
labs(title = 'Sentiment by Topic',
y = 'sentiment score',
x = ' ')+
theme_light()
table(final$customer_type)
table(raw$customer_type)
raw <- df
#segments
raw$customer_type <- table(ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == "I haven't made a purchase yet","potential",
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == "This is my first purchsae","new",
"existing")))
table(raw$customer_type)
table(raw$How.often.do.you.purchase.from.THE.ICONIC.)
#segments
raw$customer_type <- table(ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == "I haven't made a purchase yet","potential",
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == "This is my first purchsae","new",
"existing")))
View(raw)
raw$customer_type <- table(ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == "I haven't made a purchase yet","potential",
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == "This is my first purchase","new",
"existing")))
#segments
raw$customer_type <- table(ifelse(str_replace_all(raw$How.often.do.you.purchase.from.THE.ICONIC., "[[:punct:]]", " ") == "I haven t made a purchase yet","potential",
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == "This is my first purchase","new",
"existing")))
#segments
raw$customer_type <- table(ifelse(str_replace_all(raw$How.often.do.you.purchase.from.THE.ICONIC., "[[:punct:]]", " ") == 'I haven t made a purchase yet','potential',
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == 'This is my first purchase','new',
'existing')))
#segments
raw$customer_type <- ifelse(str_replace_all(raw$How.often.do.you.purchase.from.THE.ICONIC., "[[:punct:]]", " ") == 'I haven t made a purchase yet','potential',
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == 'This is my first purchase','new',
'existing'))
table(raw$customer_type)
#segments
raw$customer_type <- ifelse(str_replace_all(raw$How.often.do.you.purchase.from.THE.ICONIC., "[[:punct:]]", " ") == 'I haven t made a purchase yet','new',
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == 'This is my first purchase','new',
'existing'))
table(raw$customer_type)
raw <- df
#segments
raw$customer_type <- ifelse(str_replace_all(raw$How.often.do.you.purchase.from.THE.ICONIC., "[[:punct:]]", " ") == 'I haven t made a purchase yet','new',
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == 'This is my first purchase','new',
'existing'))
#reshape data
subdf <- raw %>%
subset(!is.na(For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.)) %>%
select(Response.ID,customer_type,Time.Started,City,For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
mutate(month = round_date(as.Date(Time.Started),"month")) %>%
select(month,customer_type,Response.ID,City,For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
dplyr::rename(feedback = For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
mutate(feedback = as.character(feedback),month = as.character(month))
#keywords
word_list <- data.frame(variable = subdf$feedback,stringsAsFactors =F ) %>%
mutate(variable = str_replace_all(variable, "[[:punct:]]", " ")) %>%
mutate(variable = str_split(variable,' ')) %>%
unnest() %>% subset(grepl("[A-Za-z]", variable)) %>%
mutate(variable = tolower(variable)) %>%
mutate(var_length = nchar(variable)) %>%
subset(var_length > 2)
word_list <- as.data.frame(table(word_list$variable))
word_list$perc <- round(word_list$Freq / sum(word_list$Freq),4)
#attribution
subdf$social <- ifelse(grepl("soci|facebook|facbook|faceb|influenc|instagram|pinterest|snapc|qzone|weibo|twitter|reddit|flickr|linkedin|whtasapp|vlogger|tweet|tumblr|post|blog", subdf$feedback),1,0)
subdf$sea <- ifelse(grepl("adwo|search add|organic|yahoo", subdf$feedback),1,0)
subdf$seo <- ifelse(grepl("seo|google|organic|yahoo", subdf$feedback),1,0)
subdf$crm <- ifelse(grepl("newsletter|mail|notifi", subdf$feedback),1,0)
subdf$display <- ifelse(grepl("banner|display", subdf$feedback),1,0)
subdf$iconic <- ifelse(grepl("iconic", subdf$feedback),1,0)
subdf$pricing <- ifelse(grepl("price|bargain|cheap|expensive|deal|sale|discount|vouch", subdf$feedback),1,0)
subdf$shipping <- ifelse(grepl("ship", subdf$feedback),1,0)
subdf$presentation <- ifelse(grepl("pictur|photo|photo|models|video|graph|virtual|visual|diversit",subdf$feedback),1,0)
subdf$features <- ifelse(grepl("watchlist|web|page|recommend|perso.nal|shop|wishlist|inspir|interact|scroll|lookbook",subdf$feedback),1,0)
subdf$brands <- ifelse(grepl("adidas|nike|billabong|birkenstock|birdsnest|tommi|tomboy|reebok|ralph|lauren|oxygen",subdf$feedback),1,0)
subdf$assortment <- ifelse(grepl("assort|baby|babie|basics|basketball|baskets|beach|black|blazer|waterproof|uniform|trainer|tracksuit|toddler|theiconicmen|theiconicsports|shirt|jeans|swim|sunglass|summer|racewear|race|petit|outerwear|outdoor|styles|outfit|tailored|variety|accessor|colour|categories|festival|everywhere",subdf$feedback),1,0)
sent <- with(subdf,sentiment_by(get_sentences(feedback),list(Response.ID)))
out <- merge(subdf,sent,by = "Response.ID")
social <- out %>% subset(social == 1) %>% mutate(topic = paste0('social (',nrow(out %>% subset(social == 1)),')'))
sea <- out %>% subset(sea == 1) %>% mutate(topic = paste0('sea (',nrow(out %>% subset(sea == 1)),')'))
seo <- out %>% subset(seo == 1) %>% mutate(topic = paste0('seo (',nrow(out %>% subset(seo == 1)),')'))
crm <- out %>% subset(crm == 1) %>% mutate(topic = paste0('crm (',nrow(out %>% subset(crm == 1)),')'))
display  <- out %>% subset(display == 1) %>% mutate(topic = paste0('display (',nrow(out %>% subset(display == 1)),')'))
iconic <- out %>% subset(iconic == 1) %>% mutate(topic = paste0('iconic (',nrow(out %>% subset(iconic == 1)),')'))
pricing  <- out %>% subset(pricing == 1) %>% mutate(topic = paste0('pricing (',nrow(out %>% subset(pricing == 1)),')'))
shipping  <- out %>% subset(shipping == 1) %>% mutate(topic = paste0('shipping (',nrow(out %>% subset(shipping == 1)),')'))
presentation  <- out %>% subset(presentation == 1) %>% mutate(topic = paste0('presentation (',nrow(out %>% subset(presentation == 1)),')'))
features  <- out %>% subset(features == 1) %>% mutate(topic = paste0('features (',nrow(out %>% subset(features == 1)),')'))
brands  <- out %>% subset(brands == 1) %>% mutate(topic = paste0('brands (',nrow(out %>% subset(brands == 1)),')'))
assortment  <- out %>% subset(assortment == 1) %>% mutate(topic = paste0('assortment (',nrow(out %>% subset(assortment == 1)),')'))
final <- rbind(social,sea,seo,crm,display,iconic,pricing,shipping,presentation,features,brands,assortment)
ggplot(final, aes(x=reorder(topic,ave_sentiment,FUN= median),y=ave_sentiment,col
ggplot(final, aes(x=customer_type,y=ave_sentiment,color=month)) +
geom_boxplot()+
#facet_grid(connie_applink_active~.,scales = "free")+
scale_y_continuous(breaks = seq(-2,2, by=.25), limits = c(-1.25,2.25))+
#atlassian_theme +
labs(title = 'Sentiment by Topic',
y = 'sentiment score',
x = ' ')+
theme_light()
ggplot(out, aes(x=customer_type,y=ave_sentiment,color=month)) +
geom_boxplot()+
#facet_grid(connie_applink_active~.,scales = "free")+
scale_y_continuous(breaks = seq(-2,2, by=.25), limits = c(-1.25,2.25))+
#atlassian_theme +
labs(title = 'Sentiment by Topic',
y = 'sentiment score',
x = ' ')+
theme_light()
ggplot(out, aes(x=customer_type,y=ave_sentiment,color=customer_type)) +
geom_boxplot()+
#facet_grid(connie_applink_active~.,scales = "free")+
scale_y_continuous(breaks = seq(-2,2, by=.25), limits = c(-1.25,2.25))+
#atlassian_theme +
labs(title = 'Sentiment by Topic',
y = 'sentiment score',
x = ' ')+
theme_light()
ggplot(final, aes(x=reorder(topic,ave_sentiment,FUN= median),y=ave_sentiment,color=topic)) +
geom_boxplot()+
facet_grid(customer_type~.,scales = "free")+
scale_y_continuous(breaks = seq(-2,2, by=.25), limits = c(-1.25,2.25))+
#atlassian_theme +
labs(title = 'Sentiment by Topic',
y = 'sentiment score',
x = ' ')+
theme_light()
df <- read.csv("20180830003631-SurveyExport - 20180830003631-SurveyExport.csv")
raw <- df
#segments
raw$customer_type <- ifelse(str_replace_all(raw$How.often.do.you.purchase.from.THE.ICONIC., "[[:punct:]]", " ") == 'I haven t made a purchase yet','new',
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == 'This is my first purchase','new',
'existing'))
#reshape data
subdf <- raw %>%
subset(!is.na(For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.)) %>%
select(Response.ID,customer_type,Time.Started,City,For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
mutate(month = round_date(as.Date(Time.Started),"month")) %>%
select(month,customer_type,Response.ID,City,For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
dplyr::rename(feedback = For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
mutate(feedback = as.character(feedback),month = as.character(month))
#keywords
word_list <- data.frame(variable = subdf$feedback,stringsAsFactors =F ) %>%
mutate(variable = str_replace_all(variable, "[[:punct:]]", " ")) %>%
mutate(variable = str_split(variable,' ')) %>%
unnest() %>% subset(grepl("[A-Za-z]", variable)) %>%
mutate(variable = tolower(variable)) %>%
mutate(var_length = nchar(variable)) %>%
subset(var_length > 2)
word_list <- as.data.frame(table(word_list$variable))
word_list$perc <- round(word_list$Freq / sum(word_list$Freq),4)
#attribution
subdf$social <- ifelse(grepl("soci|facebook|facbook|faceb|influenc|instagram|pinterest|snapc|qzone|weibo|twitter|reddit|flickr|linkedin|whtasapp|vlogger|tweet|tumblr|post|blog", subdf$feedback),1,0)
subdf$search <- ifelse(grepl("adwo|search|organic|yahoo|seo|google|yahoo|link", subdf$feedback),1,0)
subdf$crm <- ifelse(grepl("mail|notifi|mial|news.letter", subdf$feedback),1,0)
subdf$display <- ifelse(grepl("banner|display|add", subdf$feedback),1,0)
#subdf$iconic <- ifelse(grepl("iconic", subdf$feedback),1,0)
subdf$promo <- ifelse(grepl("price|bargain|cheap|expensive|deal|sale|discount|vouch|promo|offer", subdf$feedback),1,0)
subdf$shipping <- ifelse(grepl("ship|deliv", subdf$feedback),1,0)
subdf$presentation <- ifelse(grepl("pictur|photo|photo|models|video|graph|virtual|visual|diversit",subdf$feedback),1,0)
subdf$features <- ifelse(grepl("watchlist|web|page|recommend|perso.nal|wishlist|inspir|interact|scroll|lookbook",subdf$feedback),1,0)
subdf$loyalty <- ifelse(grepl("loya|rewar|progra",subdf$feedback),1,0)
subdf$assortment <- ifelse(grepl("brand|adidas|nike|billabong|birkenstock|birdsnest|tommi|tomboy|reebok|ralph|lauren|oxygen|assort|baby|babie|basics|basketball|baskets|beach|black|blazer|waterproof|uniform|trainer|tracksuit|toddler|theiconicmen|theiconicsports|shirt|jeans|swim|sunglass|summer|racewear|race|petit|outerwear|outdoor|styles|outfit|tailored|variety|accessor|colour|categories|festival|everywhere",subdf$feedback),1,0)
sent <- with(subdf,sentiment_by(get_sentences(feedback),list(Response.ID)))
out <- merge(subdf,sent,by = "Response.ID")
social <- out %>% subset(social == 1) %>% mutate(topic = paste0('social (',nrow(out %>% subset(social == 1)),')'))
sea <- out %>% subset(sea == 1) %>% mutate(topic = paste0('sea (',nrow(out %>% subset(sea == 1)),')'))
seo <- out %>% subset(seo == 1) %>% mutate(topic = paste0('seo (',nrow(out %>% subset(seo == 1)),')'))
crm <- out %>% subset(crm == 1) %>% mutate(topic = paste0('crm (',nrow(out %>% subset(crm == 1)),')'))
display  <- out %>% subset(display == 1) %>% mutate(topic = paste0('display (',nrow(out %>% subset(display == 1)),')'))
iconic <- out %>% subset(iconic == 1) %>% mutate(topic = paste0('iconic (',nrow(out %>% subset(iconic == 1)),')'))
pricing  <- out %>% subset(pricing == 1) %>% mutate(topic = paste0('pricing (',nrow(out %>% subset(pricing == 1)),')'))
shipping  <- out %>% subset(shipping == 1) %>% mutate(topic = paste0('shipping (',nrow(out %>% subset(shipping == 1)),')'))
presentation  <- out %>% subset(presentation == 1) %>% mutate(topic = paste0('presentation (',nrow(out %>% subset(presentation == 1)),')'))
features  <- out %>% subset(features == 1) %>% mutate(topic = paste0('features (',nrow(out %>% subset(features == 1)),')'))
brands  <- out %>% subset(brands == 1) %>% mutate(topic = paste0('brands (',nrow(out %>% subset(brands == 1)),')'))
assortment  <- out %>% subset(assortment == 1) %>% mutate(topic = paste0('assortment (',nrow(out %>% subset(assortment == 1)),')'))
final <- rbind(social,sea,seo,crm,display,iconic,pricing,shipping,presentation,features,brands,assortment)
ggplot(final, aes(x=reorder(topic,ave_sentiment,FUN= median),y=ave_sentiment,color=topic)) +
geom_boxplot()+
facet_grid(customer_type~.,scales = "free")+
scale_y_continuous(breaks = seq(-2,2, by=.25), limits = c(-1.25,2.25))+
#atlassian_theme +
labs(title = 'Sentiment by Topic',
y = 'sentiment score',
x = ' ')+
theme_light()
ggplot(final, aes(x=reorder(topic,ave_sentiment,FUN= median),y=ave_sentiment,color=topic)) +
geom_boxplot()+
#facet_grid(customer_type~.,scales = "free")+
scale_y_continuous(breaks = seq(-2,2, by=.25), limits = c(-1.25,2.25))+
#atlassian_theme +
labs(title = 'Sentiment by Topic',
y = 'sentiment score',
x = ' ')+
theme_light()
ggplot(final, aes(x=reorder(topic,ave_sentiment,FUN= median),y=ave_sentiment,color=topic)) +
geom_boxplot()+
#facet_grid(customer_type~.,scales = "free")+
scale_y_continuous(breaks = seq(-2,2, by=.25), limits = c(-1.25,2.25))+
#atlassian_theme +
coord_flip() +
labs(title = 'Sentiment by Topic',
y = 'sentiment score',
x = ' ')+
theme_light()
summary(final$ave_sentiment)
df <- read.csv("20180830003631-SurveyExport - 20180830003631-SurveyExport.csv")
raw <- df
#segments
raw$customer_type <- ifelse(str_replace_all(raw$How.often.do.you.purchase.from.THE.ICONIC., "[[:punct:]]", " ") == 'I haven t made a purchase yet','new',
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == 'This is my first purchase','new',
'existing'))
#reshape data
subdf <- raw %>%
subset(!is.na(For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.)) %>%
select(Response.ID,customer_type,Time.Started,City,For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
mutate(month = round_date(as.Date(Time.Started),"month")) %>%
select(month,customer_type,Response.ID,City,For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
dplyr::rename(feedback = For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
mutate(feedback = as.character(feedback),month = as.character(month))
#keywords
word_list <- data.frame(variable = subdf$feedback,stringsAsFactors =F ) %>%
mutate(variable = str_replace_all(variable, "[[:punct:]]", " ")) %>%
mutate(variable = str_split(variable,' ')) %>%
unnest() %>% subset(grepl("[A-Za-z]", variable)) %>%
mutate(variable = tolower(variable)) %>%
mutate(var_length = nchar(variable)) %>%
subset(var_length > 2)
word_list <- as.data.frame(table(word_list$variable))
word_list$perc <- round(word_list$Freq / sum(word_list$Freq),4)
#attribution
subdf$social <- ifelse(grepl("soci|facebook|facbook|faceb|influenc|instagram|pinterest|snapc|qzone|weibo|twitter|reddit|flickr|linkedin|whtasapp|vlogger|tweet|tumblr|post|blog", subdf$feedback),1,0)
subdf$search <- ifelse(grepl("adwo|search|organic|yahoo|seo|google|yahoo|link", subdf$feedback),1,0)
subdf$crm <- ifelse(grepl("mail|notifi|mial|news.letter", subdf$feedback),1,0)
subdf$display <- ifelse(grepl("banner|display|add", subdf$feedback),1,0)
#subdf$iconic <- ifelse(grepl("iconic", subdf$feedback),1,0)
subdf$promo <- ifelse(grepl("price|bargain|cheap|expensive|deal|sale|discount|vouch|promo|offer", subdf$feedback),1,0)
subdf$shipping <- ifelse(grepl("ship|deliv", subdf$feedback),1,0)
subdf$presentation <- ifelse(grepl("pictur|photo|photo|models|video|graph|virtual|visual|diversit",subdf$feedback),1,0)
subdf$features <- ifelse(grepl("watchlist|web|page|recommend|perso.nal|wishlist|inspir|interact|scroll|lookbook",subdf$feedback),1,0)
subdf$loyalty <- ifelse(grepl("loya|rewar|progra",subdf$feedback),1,0)
subdf$assortment <- ifelse(grepl("brand|adidas|nike|billabong|birkenstock|birdsnest|tommi|tomboy|reebok|ralph|lauren|oxygen|assort|baby|babie|basics|basketball|baskets|beach|black|blazer|waterproof|uniform|trainer|tracksuit|toddler|theiconicmen|theiconicsports|shirt|jeans|swim|sunglass|summer|racewear|race|petit|outerwear|outdoor|styles|outfit|tailored|variety|accessor|colour|categories|festival|everywhere",subdf$feedback),1,0)
sent <- with(subdf,sentiment_by(get_sentences(feedback),list(Response.ID)))
out <- merge(subdf,sent,by = "Response.ID")
social <- out %>% subset(social == 1) %>% mutate(topic = paste0('social (',nrow(out %>% subset(social == 1)),')'))
sea <- out %>% subset(sea == 1) %>% mutate(topic = paste0('sea (',nrow(out %>% subset(sea == 1)),')'))
seo <- out %>% subset(seo == 1) %>% mutate(topic = paste0('seo (',nrow(out %>% subset(seo == 1)),')'))
crm <- out %>% subset(crm == 1) %>% mutate(topic = paste0('crm (',nrow(out %>% subset(crm == 1)),')'))
display  <- out %>% subset(display == 1) %>% mutate(topic = paste0('display (',nrow(out %>% subset(display == 1)),')'))
#iconic <- out %>% subset(iconic == 1) %>% mutate(topic = paste0('iconic (',nrow(out %>% subset(iconic == 1)),')'))
pricing  <- out %>% subset(pricing == 1) %>% mutate(topic = paste0('pricing (',nrow(out %>% subset(pricing == 1)),')'))
shipping  <- out %>% subset(shipping == 1) %>% mutate(topic = paste0('shipping (',nrow(out %>% subset(shipping == 1)),')'))
presentation  <- out %>% subset(presentation == 1) %>% mutate(topic = paste0('presentation (',nrow(out %>% subset(presentation == 1)),')'))
features  <- out %>% subset(features == 1) %>% mutate(topic = paste0('features (',nrow(out %>% subset(features == 1)),')'))
brands  <- out %>% subset(brands == 1) %>% mutate(topic = paste0('brands (',nrow(out %>% subset(brands == 1)),')'))
assortment  <- out %>% subset(assortment == 1) %>% mutate(topic = paste0('assortment (',nrow(out %>% subset(assortment == 1)),')'))
final <- rbind(social,sea,seo,crm,display,iconic,pricing,shipping,presentation,features,brands,assortment)
ggplot(final, aes(x=reorder(topic,ave_sentiment,FUN= median),y=ave_sentiment,color=topic)) +
geom_boxplot()+
#facet_grid(customer_type~.,scales = "free")+
scale_y_continuous(breaks = seq(-2,2, by=.25), limits = c(-1.25,2.25))+
#atlassian_theme +
coord_flip() +
labs(title = 'Sentiment by Topic',
y = 'sentiment score',
x = ' ')+
theme_light()
setwd("/Users/mickey/Documents/GitHub/data-products/seli_app")
#get data
df <- read.csv("20180830003631-SurveyExport - 20180830003631-SurveyExport.csv")
raw <- df
#segments
raw$customer_type <- ifelse(str_replace_all(raw$How.often.do.you.purchase.from.THE.ICONIC., "[[:punct:]]", " ") == 'I haven t made a purchase yet','new',
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == 'This is my first purchase','new',
'existing'))
#reshape data
subdf <- raw %>%
subset(!is.na(For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.)) %>%
select(Response.ID,customer_type,Time.Started,City,For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
mutate(month = round_date(as.Date(Time.Started),"month")) %>%
select(month,customer_type,Response.ID,City,For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
dplyr::rename(feedback = For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
mutate(feedback = as.character(feedback),month = as.character(month))
#keywords
word_list <- data.frame(variable = subdf$feedback,stringsAsFactors =F ) %>%
mutate(variable = str_replace_all(variable, "[[:punct:]]", " ")) %>%
mutate(variable = str_split(variable,' ')) %>%
unnest() %>% subset(grepl("[A-Za-z]", variable)) %>%
mutate(variable = tolower(variable)) %>%
mutate(var_length = nchar(variable)) %>%
subset(var_length > 2)
word_list <- as.data.frame(table(word_list$variable))
word_list$perc <- round(word_list$Freq / sum(word_list$Freq),4)
#attribution
subdf$social <- ifelse(grepl("soci|facebook|facbook|faceb|influenc|instagram|pinterest|snapc|qzone|weibo|twitter|reddit|flickr|linkedin|whtasapp|vlogger|tweet|tumblr|post|blog", subdf$feedback),1,0)
subdf$search <- ifelse(grepl("adwo|search|organic|yahoo|seo|google|yahoo|link", subdf$feedback),1,0)
subdf$crm <- ifelse(grepl("mail|notifi|mial|news.letter", subdf$feedback),1,0)
subdf$display <- ifelse(grepl("banner|display|add", subdf$feedback),1,0)
#subdf$iconic <- ifelse(grepl("iconic", subdf$feedback),1,0)
subdf$promo <- ifelse(grepl("price|bargain|cheap|expensive|deal|sale|discount|vouch|promo|offer", subdf$feedback),1,0)
subdf$shipping <- ifelse(grepl("ship|deliv", subdf$feedback),1,0)
subdf$presentation <- ifelse(grepl("pictur|photo|photo|models|video|graph|virtual|visual|diversit",subdf$feedback),1,0)
subdf$features <- ifelse(grepl("watchlist|web|page|recommend|perso.nal|wishlist|inspir|interact|scroll|lookbook",subdf$feedback),1,0)
subdf$loyalty <- ifelse(grepl("loya|rewar|progra",subdf$feedback),1,0)
subdf$assortment <- ifelse(grepl("brand|adidas|nike|billabong|birkenstock|birdsnest|tommi|tomboy|reebok|ralph|lauren|oxygen|assort|baby|babie|basics|basketball|baskets|beach|black|blazer|waterproof|uniform|trainer|tracksuit|toddler|theiconicmen|theiconicsports|shirt|jeans|swim|sunglass|summer|racewear|race|petit|outerwear|outdoor|styles|outfit|tailored|variety|accessor|colour|categories|festival|everywhere",subdf$feedback),1,0)
sent <- with(subdf,sentiment_by(get_sentences(feedback),list(Response.ID)))
out <- merge(subdf,sent,by = "Response.ID")
social <- out %>% subset(social == 1) %>% mutate(topic = paste0('social (',nrow(out %>% subset(social == 1)),')'))
sea <- out %>% subset(sea == 1) %>% mutate(topic = paste0('sea (',nrow(out %>% subset(sea == 1)),')'))
seo <- out %>% subset(seo == 1) %>% mutate(topic = paste0('seo (',nrow(out %>% subset(seo == 1)),')'))
crm <- out %>% subset(crm == 1) %>% mutate(topic = paste0('crm (',nrow(out %>% subset(crm == 1)),')'))
display  <- out %>% subset(display == 1) %>% mutate(topic = paste0('display (',nrow(out %>% subset(display == 1)),')'))
#iconic <- out %>% subset(iconic == 1) %>% mutate(topic = paste0('iconic (',nrow(out %>% subset(iconic == 1)),')'))
promo  <- out %>% subset(promo == 1) %>% mutate(topic = paste0('promo (',nrow(out %>% subset(promo == 1)),')'))
shipping  <- out %>% subset(shipping == 1) %>% mutate(topic = paste0('shipping (',nrow(out %>% subset(shipping == 1)),')'))
presentation  <- out %>% subset(presentation == 1) %>% mutate(topic = paste0('presentation (',nrow(out %>% subset(presentation == 1)),')'))
features  <- out %>% subset(features == 1) %>% mutate(topic = paste0('features (',nrow(out %>% subset(features == 1)),')'))
brands  <- out %>% subset(brands == 1) %>% mutate(topic = paste0('brands (',nrow(out %>% subset(brands == 1)),')'))
assortment  <- out %>% subset(assortment == 1) %>% mutate(topic = paste0('assortment (',nrow(out %>% subset(assortment == 1)),')'))
final <- rbind(social,sea,seo,crm,display,iconic,pricing,shipping,presentation,features,brands,assortment)
ggplot(final, aes(x=reorder(topic,ave_sentiment,FUN= median),y=ave_sentiment,color=topic)) +
geom_boxplot()+
#facet_grid(customer_type~.,scales = "free")+
scale_y_continuous(breaks = seq(-2,2, by=.25), limits = c(-1.25,2.25))+
#atlassian_theme +
coord_flip() +
labs(title = 'Sentiment by Topic',
y = 'sentiment score',
x = ' ')+
theme_light()
df <- read.csv("20180830003631-SurveyExport - 20180830003631-SurveyExport.csv")
raw <- df
#segments
raw$customer_type <- ifelse(str_replace_all(raw$How.often.do.you.purchase.from.THE.ICONIC., "[[:punct:]]", " ") == 'I haven t made a purchase yet','new',
ifelse(raw$How.often.do.you.purchase.from.THE.ICONIC. == 'This is my first purchase','new',
'existing'))
#reshape data
subdf <- raw %>%
subset(!is.na(For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.)) %>%
select(Response.ID,customer_type,Time.Started,City,For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
mutate(month = round_date(as.Date(Time.Started),"month")) %>%
select(month,customer_type,Response.ID,City,For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
dplyr::rename(feedback = For.a.chance.to.win..200.voucher..please.tell.us.in.100.words.or.less..what.type.of.advertising.you.d.like.to.see.from.us.and.how.we.can.improve.Â.) %>%
mutate(feedback = as.character(feedback),month = as.character(month))
#keywords
word_list <- data.frame(variable = subdf$feedback,stringsAsFactors =F ) %>%
mutate(variable = str_replace_all(variable, "[[:punct:]]", " ")) %>%
mutate(variable = str_split(variable,' ')) %>%
unnest() %>% subset(grepl("[A-Za-z]", variable)) %>%
mutate(variable = tolower(variable)) %>%
mutate(var_length = nchar(variable)) %>%
subset(var_length > 2)
word_list <- as.data.frame(table(word_list$variable))
word_list$perc <- round(word_list$Freq / sum(word_list$Freq),4)
#attribution
subdf$social <- ifelse(grepl("soci|facebook|facbook|faceb|influenc|instagram|pinterest|snapc|qzone|weibo|twitter|reddit|flickr|linkedin|whtasapp|vlogger|tweet|tumblr|post|blog", subdf$feedback),1,0)
subdf$search <- ifelse(grepl("adwo|search|organic|yahoo|seo|google|yahoo|link", subdf$feedback),1,0)
subdf$crm <- ifelse(grepl("mail|notifi|mial|news.letter", subdf$feedback),1,0)
subdf$display <- ifelse(grepl("banner|display|add", subdf$feedback),1,0)
#subdf$iconic <- ifelse(grepl("iconic", subdf$feedback),1,0)
subdf$promo <- ifelse(grepl("price|bargain|cheap|expensive|deal|sale|discount|vouch|promo|offer", subdf$feedback),1,0)
subdf$shipping <- ifelse(grepl("ship|deliv", subdf$feedback),1,0)
subdf$presentation <- ifelse(grepl("pictur|photo|photo|models|video|graph|virtual|visual|diversit",subdf$feedback),1,0)
subdf$features <- ifelse(grepl("watchlist|web|page|recommend|perso.nal|wishlist|inspir|interact|scroll|lookbook",subdf$feedback),1,0)
subdf$loyalty <- ifelse(grepl("loya|rewar|progra",subdf$feedback),1,0)
subdf$assortment <- ifelse(grepl("brand|adidas|nike|billabong|birkenstock|birdsnest|tommi|tomboy|reebok|ralph|lauren|oxygen|assort|baby|babie|basics|basketball|baskets|beach|black|blazer|waterproof|uniform|trainer|tracksuit|toddler|theiconicmen|theiconicsports|shirt|jeans|swim|sunglass|summer|racewear|race|petit|outerwear|outdoor|styles|outfit|tailored|variety|accessor|colour|categories|festival|everywhere",subdf$feedback),1,0)
sent <- with(subdf,sentiment_by(get_sentences(feedback),list(Response.ID)))
out <- merge(subdf,sent,by = "Response.ID")
social <- out %>% subset(social == 1) %>% mutate(topic = paste0('social (',nrow(out %>% subset(social == 1)),')'))
search <- out %>% subset(search == 1) %>% mutate(topic = paste0('search (',nrow(out %>% subset(search == 1)),')'))
crm <- out %>% subset(crm == 1) %>% mutate(topic = paste0('crm (',nrow(out %>% subset(crm == 1)),')'))
display  <- out %>% subset(display == 1) %>% mutate(topic = paste0('display (',nrow(out %>% subset(display == 1)),')'))
#iconic <- out %>% subset(iconic == 1) %>% mutate(topic = paste0('iconic (',nrow(out %>% subset(iconic == 1)),')'))
promo  <- out %>% subset(promo == 1) %>% mutate(topic = paste0('promo (',nrow(out %>% subset(promo == 1)),')'))
shipping  <- out %>% subset(shipping == 1) %>% mutate(topic = paste0('shipping (',nrow(out %>% subset(shipping == 1)),')'))
presentation  <- out %>% subset(presentation == 1) %>% mutate(topic = paste0('presentation (',nrow(out %>% subset(presentation == 1)),')'))
features  <- out %>% subset(features == 1) %>% mutate(topic = paste0('features (',nrow(out %>% subset(features == 1)),')'))
assortment  <- out %>% subset(assortment == 1) %>% mutate(topic = paste0('assortment (',nrow(out %>% subset(assortment == 1)),')'))
loyalty  <- out %>% subset(loyalty == 1) %>% mutate(loyalty = paste0('loyalty (',nrow(out %>% subset(loyalty == 1)),')'))
final <- rbind(social,sea,seo,crm,display,iconic,pricing,shipping,presentation,features,brands,assortment)
ggplot(final, aes(x=reorder(topic,ave_sentiment,FUN= median),y=ave_sentiment,color=topic)) +
geom_boxplot()+
#facet_grid(customer_type~.,scales = "free")+
scale_y_continuous(breaks = seq(-2,2, by=.25), limits = c(-1.25,2.25))+
#atlassian_theme +
coord_flip() +
labs(title = 'Sentiment by Topic',
y = 'sentiment score',
x = ' ')+
theme_light()
final <- rbind(social,sea,seo,crm,display,iconic,pricing,shipping,presentation,features,brands,assortment)
final <- rbind(social,search,crm,display,promo,shipping,presentation,features,loyalty,assortment)
social <- out %>% subset(social == 1) %>% mutate(topic = paste0('social (',nrow(out %>% subset(social == 1)),')'))
search <- out %>% subset(search == 1) %>% mutate(topic = paste0('search (',nrow(out %>% subset(search == 1)),')'))
crm <- out %>% subset(crm == 1) %>% mutate(topic = paste0('crm (',nrow(out %>% subset(crm == 1)),')'))
display  <- out %>% subset(display == 1) %>% mutate(topic = paste0('display (',nrow(out %>% subset(display == 1)),')'))
#iconic <- out %>% subset(iconic == 1) %>% mutate(topic = paste0('iconic (',nrow(out %>% subset(iconic == 1)),')'))
promo  <- out %>% subset(promo == 1) %>% mutate(topic = paste0('promo (',nrow(out %>% subset(promo == 1)),')'))
shipping  <- out %>% subset(shipping == 1) %>% mutate(topic = paste0('shipping (',nrow(out %>% subset(shipping == 1)),')'))
presentation  <- out %>% subset(presentation == 1) %>% mutate(topic = paste0('presentation (',nrow(out %>% subset(presentation == 1)),')'))
features  <- out %>% subset(features == 1) %>% mutate(topic = paste0('features (',nrow(out %>% subset(features == 1)),')'))
assortment  <- out %>% subset(assortment == 1) %>% mutate(topic = paste0('assortment (',nrow(out %>% subset(assortment == 1)),')'))
loyalty  <- out %>% subset(loyalty == 1) %>% mutate(loyalty = paste0('loyalty (',nrow(out %>% subset(loyalty == 1)),')'))
final <- rbind(social,search,crm,display,promo,shipping,presentation,features,loyalty,assortment)
str(promo)
str(social)
str(search)
str(crm)
str(display)
str(promo)
length(social)
length(search)
length(crm)
length(display)
length(promo)
length(shipping)
length(presentation)
length(features)
length(assortment)
length(loyalty)
names(assportment)
names(assortment)
names(loyalty)
loyalty  <- out %>% subset(loyalty == 1) %>% mutate(topic = paste0('loyalty (',nrow(out %>% subset(loyalty == 1)),')'))
names(loyalty)
final <- rbind(social,search,crm,display,promo,shipping,presentation,features,loyalty,assortment)
ggplot(final, aes(x=reorder(topic,ave_sentiment,FUN= median),y=ave_sentiment,color=topic)) +
geom_boxplot()+
#facet_grid(customer_type~.,scales = "free")+
scale_y_continuous(breaks = seq(-2,2, by=.25), limits = c(-1.25,2.25))+
#atlassian_theme +
coord_flip() +
labs(title = 'Sentiment by Topic',
y = 'sentiment score',
x = ' ')+
theme_light()
View(loyalty)
